<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/libs/katex/katex.min.css">
   
   <link rel="stylesheet" href="/libs/highlight/github.min.css">
   

  <link href="/css/franklin.css" rel="stylesheet">
<link href="/css/vela.css" rel="stylesheet">
<script src="/libs/vela/jquery.min.js"></script>

<link rel="icon" href="/assets/favicon.png">


  <title>Franklin Example | Vela</title>
</head>
<body>
<div class="main-nav slideout-menu slideout-menu-left" id="menu">
  <div class="flex-container">
    <span class="sidebar-brand">
      <h3 style='font-size: 25px'>Vela Template</h3>
    </span>
  </div> <!-- class="flex-container" -->

  <nav class="sidebar-nav">
    <ul class="metismenu"  id="metismenu" >
      <li><a href="/index.html">Home</a></li>
      <li><a href="" class="has-arrow">Lecture notes</a>
        <ul>
          <li><a href="/lecture_notes/Module1/Introduction" class="has-arrow">Module 1. Introduction to Computational Methods for ODEs</a></li>
          <ul>
            <li><a href="/lecture_notes/Module1/TaylorSeries">1.1 Taylor Series</a></li>
            <li><a href="/lecture_notes/Module1/ApproxODES">1.2 Approximating ODEs with Taylor Series</a></li>
            <li><a href="/lecture_notes/Module1/TruncationErrors">1.3 Truncation Errors</a></li>
            <li><a href="/lecture_notes/Module1/ODESolver">1.4 An ODE solver</a></li>
            <li><a href="/lecture_notes/Module1/TimeStepping">1.5 Time stepping and error control</a></li>
            <li><a href="/lecture_notes/Module1/SolverTypes">1.6 Types of solvers</a></li>
          </ul>
        </ul>
      </li>
    </ul>
  </nav>
</div> <!-- main nav menu -->

<main id="panel" class="slidout-panel slideout-panel-left">
  <div class="toggle-button hamburger hamburger--spin">
    <div class="hamburger-box">
      <div class="hamburger-inner"></div>
    </div>
  </div>
  <h1 class="page title">1.1 Taylor Series</h1>
  <hr>



<!-- Content appended here -->
<div class="franklin-content"><p>Before going into more details on how to find a numerical approximation, let&#39;s start by refreshing some theory about <strong><a href="https://en.wikipedia.org/wiki/Taylor_series">Taylor series</a></strong>. As one can find in the Wikipedia page:</p>
<blockquote>
<p>the <strong>Taylor series</strong> of a function is an infinite sum of terms that are expressed in terms of the function&#39;s derivatives at a single point.</p>
</blockquote>
<p>That is </p>
\[ f(x)=\sum_{i=0}^\infty\frac{f^{(i)}(a)}{i!}(x-a)^i. \]
<p>The series is exact for an arbitrary function as long as we include infinite terms in the sum. However, here we are interested on an approximation that includes only the first \(r\) terms of the expansion: </p>
\[ f_r(x)=\sum_{i=0}^r\frac{f^{(i)}(a)}{i!}(x-a)^i\approx f(x). \]
<p>Let&#39;s see how this work in a practical example. We consider here the function \(f(x)=\sin(x)\) and we want to approximate this function knowing the function value and its derivatives at the point \(a=0\). Using five terms in the expansion, \(r=5\), we have that </p>
\[\begin{align*}f_5(x) &= \sin(0) + x\cos(0) - \frac{x^2}{2}\sin(0) - \frac{x^3}{6}\cos(0) + \frac{x^4}{24}\sin(0) + \frac{x^5}{120}\cos(0)\\
                      &= x - \frac{x^3}{6} + \frac{x^5}{120}.
\end{align*} \]
<p>We now can do a first coding exercise with this example and see how this approximation looks like for different values of \(r\). To do so, we explicitly define the approximated functions.</p>
<pre><code class="language-julia">const a &#61; 0
f&#40;x&#41; &#61; sin&#40;x&#41;
f₀&#40;x&#41; &#61; sin&#40;a&#41;
f₁&#40;x&#41; &#61; f₀&#40;x&#41; &#43; &#40;x-a&#41;*cos&#40;a&#41;
f₂&#40;x&#41; &#61; f₁&#40;x&#41; - &#40;x-a&#41;^2/2 * sin&#40;a&#41;
f₃&#40;x&#41; &#61; f₂&#40;x&#41; - &#40;x-a&#41;^3/6 * cos&#40;a&#41;
f₄&#40;x&#41; &#61; f₃&#40;x&#41; &#43; &#40;x-a&#41;^4/24 * sin&#40;a&#41;
f₅&#40;x&#41; &#61; f₄&#40;x&#41; &#43; &#40;x-a&#41;^5/120 * cos&#40;a&#41;</code></pre>
<p>And we plot them. Here we use the package <a href="http://docs.juliaplots.org/latest/"><code>Plots.jl</code></a> that contains visualization tools and <a href="https://github.com/stevengj/LaTeXStrings.jl"><code>LaTeXStrings.jl</code></a> which is a convinient tool to use \(\LaTeX\) syntax in the plots.</p>
<pre><code class="language-julia">using Plots
using LaTeXStrings
x &#61; -2π:0.01:2π
plt &#61; plot&#40;x,f.&#40;x&#41;,
           linecolor&#61;:black,
           linewidth&#61;3,
           label&#61;L&quot;\sin&#40;x&#41;&quot;,
           xlabel&#61;L&quot;x&quot;,
           ylabel&#61;L&quot;f&#40;x&#41;&quot;,
           xlim&#61;&#91;-2π,2π&#93;,
           ylim&#61;&#91;-1.5,1.5&#93;&#41;
plot&#33;&#40;plt,x,f₀.&#40;x&#41;,line&#61;:dash,label&#61;L&quot;f_0&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,f₁.&#40;x&#41;,linewidth&#61;2,line&#61;:solid,label&#61;L&quot;f_1&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,f₂.&#40;x&#41;,line&#61;:dash,label&#61;L&quot;f_2&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,f₃.&#40;x&#41;,linewidth&#61;2,line&#61;:solid,label&#61;L&quot;f_3&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,f₄.&#40;x&#41;,line&#61;:dash,label&#61;L&quot;f_4&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,f₅.&#40;x&#41;,linewidth&#61;2,line&#61;:solid,label&#61;L&quot;f_5&#40;x&#41;&quot;&#41;</code></pre>
<img src="/assets/lecture_notes/Module1/TaylorSeries/figures/1_2.png" alt="">
<p>We see that as we increase the number of terms, the approximation gets closer to the analytical expression. Note also that for this particular example, there is no gain for \(r=2\) and \(r=4\) with respect to \(r=1\) and \(r=3\). This is caused by the fact that \(\sin(a)=0\) at the approximation point \(a=0\).</p>
<p>We can go further and evaluate and plot the error of the approximation for different values of \(m\).</p>
\[ e_m(x)=|f(x)-f_m(x)|,\qquad r=1,...,5\]
<pre><code class="language-julia">e₀&#40;x&#41;&#61;abs&#40;f&#40;x&#41;-f₀&#40;x&#41;&#41;
e₁&#40;x&#41;&#61;abs&#40;f&#40;x&#41;-f₁&#40;x&#41;&#41;
e₂&#40;x&#41;&#61;abs&#40;f&#40;x&#41;-f₂&#40;x&#41;&#41;
e₃&#40;x&#41;&#61;abs&#40;f&#40;x&#41;-f₃&#40;x&#41;&#41;
e₄&#40;x&#41;&#61;abs&#40;f&#40;x&#41;-f₄&#40;x&#41;&#41;
e₅&#40;x&#41;&#61;abs&#40;f&#40;x&#41;-f₅&#40;x&#41;&#41;

plt &#61; plot&#40;x,log.&#40;e₀.&#40;x&#41;&#41;,line&#61;:dash,label&#61;L&quot;e_0&#40;x&#41;&quot;,xlabel&#61;L&quot;x&quot;,ylabel&#61;L&quot;\log&#40;e&#40;x&#41;&#41;&quot;,&#41;
plot&#33;&#40;plt,x,log.&#40;e₁.&#40;x&#41;&#41;,linewidth&#61;2,line&#61;:solid,label&#61;L&quot;e_1&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,log.&#40;e₂.&#40;x&#41;&#41;,line&#61;:dash,label&#61;L&quot;e_2&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,log.&#40;e₃.&#40;x&#41;&#41;,linewidth&#61;2,line&#61;:solid,label&#61;L&quot;e_3&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,log.&#40;e₄.&#40;x&#41;&#41;,line&#61;:dash,label&#61;L&quot;e_4&#40;x&#41;&quot;&#41;
plot&#33;&#40;plt,x,log.&#40;e₅.&#40;x&#41;&#41;,linewidth&#61;2,line&#61;:solid,label&#61;L&quot;e_5&#40;x&#41;&quot;&#41;</code></pre>
<img src="/assets/lecture_notes/Module1/TaylorSeries/figures/1_3.png" alt="">
<p>As it is seen in the previous figure, close to the evaluation point \(a\), the approximation error decreases as we increase the number of terms in the expansion.</p>
<div class="important"><div class="important-title"><em>Now we know...</em></div>
<ul>
<li><p>How to approximate a function using a <strong>Taylor series</strong></p>
</li>
<li><p>That the approximation error is introduced when truncating the series to \(r\) finite terms</p>
</li>
<li><p>How to compute and plot the Taylor series approximation and error of a simple function</p>
</li>
</ul></div>
<h1 id="additional_material"><a href="#additional_material" class="header-anchor">Additional material</a></h1>
<p>In practise, one can use tools that facilitate the derivation of Taylor series of functions. That is the case of the package <a href="https://juliadiff.org/TaylorSeries.jl/stable/"><code>TaylorSeries.jl</code></a>, a Julia package for Taylor expansions in one or more independent variables.</p>
<div class="page-foot">
  <div class="copyright">
    &copy; Oriol Colomés. Last modified: September 02, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
  </main> <!-- end of id=main -->
  <script src="/libs/vela/metisMenu.min.js"></script>
  <script src="/libs/vela/slideout.min.js"></script>
  
    <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

  
  
    <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

  
</body>
</html>
